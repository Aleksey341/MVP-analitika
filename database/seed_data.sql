-- Тестовые данные для справочников
-- Выполняется после schema.sql

-- ========================================
-- 1. Примеры показателей для формы 1-ГМУ
-- ========================================
INSERT INTO public.indicators_catalog (code, name, unit, form_code, sort_order, category) VALUES
  ('ind_001', 'Численность населения', 'чел.', 'form_1_gmu', 1, 'Демография'),
  ('ind_002', 'Площадь территории', 'км²', 'form_1_gmu', 2, 'Территория'),
  ('ind_003', 'Количество населенных пунктов', 'ед.', 'form_1_gmu', 3, 'Территория'),
  ('ind_004', 'Бюджет муниципалитета', 'тыс. руб.', 'form_1_gmu', 4, 'Финансы'),
  ('ind_005', 'Доходы бюджета', 'тыс. руб.', 'form_1_gmu', 5, 'Финансы'),
  ('ind_006', 'Расходы бюджета', 'тыс. руб.', 'form_1_gmu', 6, 'Финансы'),
  ('ind_007', 'Количество МФЦ', 'ед.', 'form_1_gmu', 7, 'Инфраструктура'),
  ('ind_008', 'Количество школ', 'ед.', 'form_1_gmu', 8, 'Образование'),
  ('ind_009', 'Количество детских садов', 'ед.', 'form_1_gmu', 9, 'Образование'),
  ('ind_010', 'Количество больниц', 'ед.', 'form_1_gmu', 10, 'Здравоохранение')
ON CONFLICT (code) DO UPDATE
  SET name = EXCLUDED.name,
      unit = EXCLUDED.unit,
      category = EXCLUDED.category,
      sort_order = EXCLUDED.sort_order;

-- ========================================
-- 2. Примеры услуг МФЦ и других категорий
-- ========================================
INSERT INTO public.services_catalog (code, name, unit, category, sort_order) VALUES
  -- МФЦ услуги
  ('mfc_001', 'Выдача паспорта гражданина РФ', 'шт.', 'МФЦ - Паспорта и документы', 1),
  ('mfc_002', 'Замена паспорта гражданина РФ', 'шт.', 'МФЦ - Паспорта и документы', 2),
  ('mfc_003', 'Регистрация по месту жительства', 'шт.', 'МФЦ - Регистрация', 3),
  ('mfc_004', 'Регистрация по месту пребывания', 'шт.', 'МФЦ - Регистрация', 4),
  ('mfc_005', 'Оформление СНИЛС', 'шт.', 'МФЦ - Социальные услуги', 5),
  ('mfc_006', 'Оформление материнского капитала', 'шт.', 'МФЦ - Социальные услуги', 6),
  ('mfc_007', 'Получение выписки из ЕГРН', 'шт.', 'МФЦ - Недвижимость', 7),
  ('mfc_008', 'Регистрация права на недвижимость', 'шт.', 'МФЦ - Недвижимость', 8),
  ('mfc_009', 'Получение водительского удостоверения', 'шт.', 'МФЦ - Транспорт', 9),
  ('mfc_010', 'Замена водительского удостоверения', 'шт.', 'МФЦ - Транспорт', 10),
  ('mfc_011', 'Регистрация транспортного средства', 'шт.', 'МФЦ - Транспорт', 11),
  ('mfc_012', 'Оформление загранпаспорта', 'шт.', 'МФЦ - Паспорта и документы', 12),
  ('mfc_013', 'Выдача справки о судимости', 'шт.', 'МФЦ - Справки', 13),
  ('mfc_014', 'Выдача справки об отсутствии судимости', 'шт.', 'МФЦ - Справки', 14),
  ('mfc_015', 'Постановка на учет в качестве безработного', 'шт.', 'МФЦ - Занятость', 15),

  -- Коммунальные услуги
  ('util_001', 'Подключение к водоснабжению', 'шт.', 'Коммунальные услуги', 20),
  ('util_002', 'Подключение к газоснабжению', 'шт.', 'Коммунальные услуги', 21),
  ('util_003', 'Подключение к электроснабжению', 'шт.', 'Коммунальные услуги', 22),

  -- Разрешения и лицензии
  ('lic_001', 'Выдача разрешения на строительство', 'шт.', 'Лицензии и разрешения', 30),
  ('lic_002', 'Выдача разрешения на ввод объекта в эксплуатацию', 'шт.', 'Лицензии и разрешения', 31),
  ('lic_003', 'Выдача торгового патента', 'шт.', 'Лицензии и разрешения', 32),

  -- Социальные услуги
  ('soc_001', 'Оформление пособия на ребенка', 'шт.', 'Социальные выплаты', 40),
  ('soc_002', 'Оформление пенсии по старости', 'шт.', 'Социальные выплаты', 41),
  ('soc_003', 'Оформление льгот ветеранам', 'шт.', 'Социальные выплаты', 42)
ON CONFLICT (code) DO UPDATE
  SET name = EXCLUDED.name,
      unit = EXCLUDED.unit,
      category = EXCLUDED.category,
      sort_order = EXCLUDED.sort_order;

-- ========================================
-- 3. Сообщение об успешном выполнении
-- ========================================
DO $$
DECLARE
  ind_count INTEGER;
  srv_count INTEGER;
  mun_count INTEGER;
BEGIN
  SELECT COUNT(*) INTO ind_count FROM public.indicators_catalog;
  SELECT COUNT(*) INTO srv_count FROM public.services_catalog;
  SELECT COUNT(*) INTO mun_count FROM public.municipalities;

  RAISE NOTICE '✅ База данных инициализирована:';
  RAISE NOTICE '   - Муниципалитеты: %', mun_count;
  RAISE NOTICE '   - Показатели: %', ind_count;
  RAISE NOTICE '   - Услуги: %', srv_count;
END $$;
