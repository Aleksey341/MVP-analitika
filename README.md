# üìä –°–∏—Å—Ç–µ–º–∞ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–æ–≤ –õ–∏–ø–µ—Ü–∫–æ–π –æ–±–ª–∞—Å—Ç–∏

–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏ –ø–æ —Ñ–æ—Ä–º–µ 1-–ì–ú–£ —Å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º–∏ –¥–∞—à–±–æ—Ä–¥–∞–º–∏ –¥–ª—è –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–æ–≤ –õ–∏–ø–µ—Ü–∫–æ–π –æ–±–ª–∞—Å—Ç–∏.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –î–ª—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ (–º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç—ã)
- **üìù –§–æ—Ä–º–∞ 1-–ì–ú–£** - –í–Ω–µ—Å–µ–Ω–∏–µ –µ–∂–µ–º–µ—Å—è—á–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- **üöó –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ì–ò–ë–î–î** - –û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å –ø–æ –¥–æ—Ä–æ–∂–Ω–æ-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–º –ø—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏—è–º
- **üí∞ –§–∏–Ω–∞–Ω—Å—ã –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–æ–≤** - –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
- **üì§ –ò–º–ø–æ—Ä—Ç Excel** - –ú–∞—Å—Å–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ —É—Å–ª—É–≥–∞–º
- **üîê –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–æ—Å—Ç—É–ø** - –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- **üìä –û–±—â–∏–π –¥–∞—à–±–æ—Ä–¥** - –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤—Å–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º:
  - **–î–¢–ü (–ì–ò–ë–î–î)** - –î–∏–Ω–∞–º–∏–∫–∞ –∞–≤–∞—Ä–∏–π–Ω–æ—Å—Ç–∏, –∫–∞—Ä—Ç–∞ –î–¢–ü, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—Å—Ç—Ä–∞–¥–∞–≤—à–∏—Ö
  - **–£—Å–ª—É–≥–∏** - –ê–Ω–∞–ª–∏–∑ –æ–∫–∞–∑–∞–Ω–Ω—ã—Ö —É—Å–ª—É–≥, –¢–û–ü-10, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–æ–≤
- **üìà –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏** - Chart.js —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- **üé® –¢–µ–º—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è** - –°–≤–µ—Ç–ª–∞—è –∏ —Ç–µ–º–Ω–∞—è —Ç–µ–º–∞
- **üì• –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö** - –í—ã–≥—Ä—É–∑–∫–∞ –≤ Excel

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Backend**: Node.js 18+ + Express
- **Frontend**: Vanilla JavaScript + Chart.js 4.x
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL 17.5 (CNPG –∫–ª–∞—Å—Ç–µ—Ä)
- **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞**: Amvera Cloud
- **–≠–∫—Å–ø–æ—Ä—Ç**: ExcelJS
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: Helmet, Rate Limiting, bcrypt
- **–°–µ—Å—Å–∏–∏**: Express-session

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
reports-system/
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ database.js           # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL (RW/RO –ø—É–ª—ã)
‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îî‚îÄ‚îÄ auth.js              # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îú‚îÄ‚îÄ admin.js             # API –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ auth.js              # –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ gibdd.js             # API –ì–ò–ë–î–î (–î–¢–ü)
‚îÇ   ‚îî‚îÄ‚îÄ services.js          # API –¥–∞—à–±–æ—Ä–¥–∞ —É—Å–ª—É–≥
‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îú‚îÄ‚îÄ index.html           # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
‚îÇ   ‚îú‚îÄ‚îÄ dashboard.html       # –û–±—â–∏–π –¥–∞—à–±–æ—Ä–¥ (3 –≤–∫–ª–∞–¥–∫–∏)
‚îÇ   ‚îú‚îÄ‚îÄ form.html            # –§–æ—Ä–º–∞ 1-–ì–ú–£
‚îÇ   ‚îú‚îÄ‚îÄ gibdd.html           # –§–æ—Ä–º–∞ –ì–ò–ë–î–î
‚îÇ   ‚îú‚îÄ‚îÄ finance.html         # –§–∏–Ω–∞–Ω—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ change-password.html # –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ services-import.html # –ò–º–ø–æ—Ä—Ç —É—Å–ª—É–≥ (Excel)
‚îÇ   ‚îú‚îÄ‚îÄ theme.js             # –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º
‚îÇ   ‚îî‚îÄ‚îÄ styles.css           # –û–±—â–∏–µ —Å—Ç–∏–ª–∏
‚îú‚îÄ‚îÄ sql/
‚îÇ   ‚îú‚îÄ‚îÄ 01_create_services_tables.sql      # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü —É—Å–ª—É–≥
‚îÇ   ‚îú‚îÄ‚îÄ 02_seed_services_catalog.sql       # –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —É—Å–ª—É–≥ (35 —à—Ç)
‚îÇ   ‚îú‚îÄ‚îÄ 03_migrate_indicators_to_services.sql # –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ 04_generate_test_data.sql          # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îî‚îÄ‚îÄ 99_cleanup_services_data.sql       # –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ QUICK_START.md       # –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
‚îÇ   ‚îú‚îÄ‚îÄ SERVICES_IMPORT_GUIDE.md # –ì–∞–π–¥ –ø–æ –∏–º–ø–æ—Ä—Ç—É —É—Å–ª—É–≥
‚îÇ   ‚îî‚îÄ‚îÄ MIGRATION_GUIDE.md   # –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ server.js                # –ì–ª–∞–≤–Ω—ã–π —Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ README.md
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª:

```bash
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL (Amvera CNPG)
DB_HOST_RW=amvera-alex1976-cnpg-reports-db-rw
DB_HOST_RO=amvera-alex1976-cnpg-reports-db-ro
DB_HOST_R=amvera-alex1976-cnpg-reports-db-r
DB_PORT=5432
DB_NAME=reports
DB_USER=reports_admin
DB_PASSWORD=your_secure_password

# –°–µ—Å—Å–∏–∏
SESSION_SECRET=your_session_secret_key_here

# –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
NODE_ENV=production
PORT=80
```

### 3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–®–∞–≥ 1:** –°–æ–∑–¥–∞–π—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
```bash
# –í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ pgAdmin –∏–ª–∏ psql:
# - –¢–∞–±–ª–∏—Ü—ã: municipalities, users, indicator_values, indicators_catalog
# - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏, —Ç—Ä–∏–≥–≥–µ—Ä—ã
```

**–®–∞–≥ 2:** –°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è —É—Å–ª—É–≥
```bash
# –í pgAdmin –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –ø–æ –ø–æ—Ä—è–¥–∫—É:
sql/01_create_services_tables.sql
sql/02_seed_services_catalog.sql
```

**–®–∞–≥ 3:** –°–æ–∑–¥–∞–π—Ç–µ —Ç—Ä–∏–≥–≥–µ—Ä –∞–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
```sql
-- –¢—Ä–∏–≥–≥–µ—Ä –∫–æ–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ indicator_values –≤ service_values
CREATE OR REPLACE FUNCTION sync_indicator_to_service_values()
RETURNS TRIGGER AS $$
BEGIN
  IF NEW.service_id IS NOT NULL THEN
    INSERT INTO service_values (municipality_id, service_id, period_year, period_month, value_numeric)
    SELECT NEW.municipality_id, NEW.service_id, NEW.period_year, NEW.period_month,
           COALESCE(SUM(iv.value_numeric), 0)
    FROM indicator_values iv
    WHERE iv.municipality_id = NEW.municipality_id
      AND iv.service_id = NEW.service_id
      AND iv.period_year = NEW.period_year
      AND iv.period_month = NEW.period_month
    GROUP BY iv.municipality_id, iv.service_id, iv.period_year, iv.period_month
    ON CONFLICT (municipality_id, service_id, period_year, period_month)
    DO UPDATE SET value_numeric = EXCLUDED.value_numeric, updated_at = CURRENT_TIMESTAMP;
  END IF;
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER trigger_sync_to_service_values
AFTER INSERT OR UPDATE ON indicator_values
FOR EACH ROW EXECUTE FUNCTION sync_indicator_to_service_values();
```

> üìò **–ü–æ–¥—Ä–æ–±–Ω–µ–µ:** –°–º. [QUICK_START.md](QUICK_START.md) –∏ [SERVICES_IMPORT_GUIDE.md](SERVICES_IMPORT_GUIDE.md)

### 4. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
npm run dev

# –ü—Ä–æ–¥–∞–∫—à–Ω
npm start
```

## üîê –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

1. **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä** (`role: 'admin'`)
   - –î–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º
   - –ü—Ä–æ—Å–º–æ—Ç—Ä –æ–±—â–µ–≥–æ –¥–∞—à–±–æ—Ä–¥–∞
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

2. **–û–ø–µ—Ä–∞—Ç–æ—Ä –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞** (`role: 'municipality'`)
   - –í–Ω–µ—Å–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç–æ–ª—å–∫–æ —Å–≤–æ–µ–≥–æ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞
   - –î–æ—Å—Ç—É–ø –∫ —Ñ–æ—Ä–º–∞–º 1-–ì–ú–£, –ì–ò–ë–î–î, –§–∏–Ω–∞–Ω—Å—ã
   - –ò–º–ø–æ—Ä—Ç Excel

### –ü–µ—Ä–≤—ã–π –≤—Ö–æ–¥

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ —Å–∏—Å—Ç–µ–º–∞ —Ç—Ä–µ–±—É–µ—Ç —Å–º–µ–Ω—É –ø–∞—Ä–æ–ª—è:
- –ü–æ–ª–µ `password_reset_required = true` –≤ —Ç–∞–±–ª–∏—Ü–µ `users`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/change-password.html`

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

- `POST /api/auth/login` - –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
- `POST /api/auth/logout` - –í—ã—Ö–æ–¥
- `GET /api/auth/me` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- `POST /api/auth/change-password` - –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è

## üåê API Endpoints

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- `POST /api/auth/login` - –í—Ö–æ–¥ (municipality_id, password)
- `POST /api/auth/logout` - –í—ã—Ö–æ–¥
- `GET /api/auth/me` - –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- `POST /api/auth/change-password` - –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è

### –û–±—â–∏–µ
- `GET /api/municipalities` - –°–ø–∏—Å–æ–∫ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–æ–≤ (—Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏)
- `GET /api/municipalities/all` - –í—Å–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç—ã
- `GET /api/indicators-catalog` - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
- `GET /health` - –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

### –û—Ç—á–µ—Ç—ã (–§–æ—Ä–º–∞ 1-–ì–ú–£)
- `POST /api/reports/save` - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–∞
- `GET /api/reports` - –°–ø–∏—Å–æ–∫ –æ—Ç—á–µ—Ç–æ–≤
- `GET /api/reports/values` - –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π

### –î–∞—à–±–æ—Ä–¥ –ì–ò–ë–î–î
- `GET /api/gibdd/dashboard/data` - –î–∞–Ω–Ω—ã–µ –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞ –î–¢–ü
  - KPI: –í—Å–µ–≥–æ –î–¢–ü, –ü–æ–≥–∏–±—à–∏–µ, –†–∞–Ω–µ–Ω—ã–µ
  - –î–∏–Ω–∞–º–∏–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º
  - –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ç–∏–ø–∞–º
  - –¢–û–ü –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–æ–≤

### –î–∞—à–±–æ—Ä–¥ —É—Å–ª—É–≥
- `GET /api/services-dashboard/data` - –î–∞–Ω–Ω—ã–µ –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞ —É—Å–ª—É–≥
  - KPI: –í—Å–µ–≥–æ —É—Å–ª—É–≥, –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫ –ø—Ä–µ–¥. –≥–æ–¥—É
  - –î–∏–Ω–∞–º–∏–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º
  - –¢–û–ü-10 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —É—Å–ª—É–≥
  - –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
  - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–æ–≤

### –ò–º–ø–æ—Ä—Ç
- `POST /api/import/service-values` - –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö —É—Å–ª—É–≥ –∏–∑ Excel
- `GET /api/services-catalog` - –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —É—Å–ª—É–≥
- `GET /api/service-values` - –ó–Ω–∞—á–µ–Ω–∏—è —É—Å–ª—É–≥
- `POST /api/service-values/save` - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π —É—Å–ª—É–≥

### –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
- `GET /api/admin/users` - –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `POST /api/admin/users` - –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `PUT /api/admin/users/:id` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `DELETE /api/admin/users/:id` - –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `POST /api/admin/users/:id/reset-password` - –°–±—Ä–æ—Å –ø–∞—Ä–æ–ª—è

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

#### municipalities
–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–æ–≤
```sql
CREATE TABLE municipalities (
  id SERIAL PRIMARY KEY,
  name VARCHAR(255) NOT NULL,
  code VARCHAR(50),
  region VARCHAR(100)
);
```

#### users
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã
```sql
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  municipality_id INTEGER REFERENCES municipalities(id),
  username VARCHAR(100) UNIQUE NOT NULL,
  password_hash VARCHAR(255) NOT NULL,
  role VARCHAR(50) DEFAULT 'municipality',
  password_reset_required BOOLEAN DEFAULT TRUE,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### indicators_catalog
–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
```sql
CREATE TABLE indicators_catalog (
  id SERIAL PRIMARY KEY,
  name TEXT NOT NULL,
  unit VARCHAR(50),
  category VARCHAR(100)
);
```

#### indicator_values
–ó–Ω–∞—á–µ–Ω–∏—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π (–§–æ—Ä–º–∞ 1-–ì–ú–£)
```sql
CREATE TABLE indicator_values (
  id SERIAL PRIMARY KEY,
  municipality_id INTEGER REFERENCES municipalities(id),
  service_id INTEGER REFERENCES services_catalog(id),
  indicator_id INTEGER REFERENCES indicators_catalog(id),
  period_year INTEGER NOT NULL,
  period_month INTEGER NOT NULL,
  value_numeric NUMERIC(15,2),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  UNIQUE(municipality_id, indicator_id, period_year, period_month)
);
```

#### services_catalog
–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ —É—Å–ª—É–≥ (35 —É—Å–ª—É–≥ –≤ 7 –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö)
```sql
CREATE TABLE services_catalog (
  id SERIAL PRIMARY KEY,
  name VARCHAR(255) UNIQUE NOT NULL,
  category VARCHAR(100),
  description TEXT,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### service_values
–ó–Ω–∞—á–µ–Ω–∏—è —É—Å–ª—É–≥ (–¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞)
```sql
CREATE TABLE service_values (
  id SERIAL PRIMARY KEY,
  municipality_id INTEGER NOT NULL,
  service_id INTEGER NOT NULL,
  period_year INTEGER NOT NULL,
  period_month INTEGER NOT NULL CHECK (period_month >= 1 AND period_month <= 12),
  value_numeric NUMERIC(15,2) DEFAULT 0,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  UNIQUE(municipality_id, service_id, period_year, period_month)
);
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

**–¢—Ä–∏–≥–≥–µ—Ä** `trigger_sync_to_service_values` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ `indicator_values` –≤ `service_values` –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ Excel.

## üìä –î–∞—à–±–æ—Ä–¥

### –í–∫–ª–∞–¥–∫–∞ "–î–¢–ü (–ì–ò–ë–î–î)"
- **KPI**: –í—Å–µ–≥–æ –î–¢–ü, –ü–æ–≥–∏–±—à–∏–µ, –†–∞–Ω–µ–Ω—ã–µ (—Å % –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –∫ –ø—Ä–µ–¥. –≥–æ–¥—É)
- **–ì—Ä–∞—Ñ–∏–∫**: –î–∏–Ω–∞–º–∏–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º
- **–î–∏–∞–≥—Ä–∞–º–º–∞**: –¢–∏–ø—ã –î–¢–ü (—Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ, –Ω–∞–µ–∑–¥ –∏ —Ç.–¥.)
- **–†–µ–π—Ç–∏–Ω–≥**: –¢–û–ü –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–æ–≤ –ø–æ –î–¢–ü

### –í–∫–ª–∞–¥–∫–∞ "–£—Å–ª—É–≥–∏"
- **KPI**: –í—Å–µ–≥–æ —É—Å–ª—É–≥ –æ–∫–∞–∑–∞–Ω–æ (—Å % –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º)
- **–ì—Ä–∞—Ñ–∏–∫**: –î–∏–Ω–∞–º–∏–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º
- **–ì—Ä–∞—Ñ–∏–∫**: –¢–û–ü-10 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —É—Å–ª—É–≥
- **–ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞**: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- **–†–µ–π—Ç–∏–Ω–≥**: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–æ–≤

### –§–∏–ª—å—Ç—Ä—ã
- **–ì–æ–¥**: 2023-2025
- **–ú–µ—Å—è—Ü**: 1-12
- **–ú—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç**: –í—Å–µ –∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π

### –¢–µ–º—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è
- üåô **–¢–µ–º–Ω–∞—è** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- ‚òÄÔ∏è **–°–≤–µ—Ç–ª–∞—è**

## üé® UI/UX –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- ‚ú® –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –∏–∫–æ–Ω–∫–∞–º–∏
- üéØ Hover-—ç—Ñ—Ñ–µ–∫—Ç—ã (–ø–æ–¥—ä–µ–º, –≥—Ä–∞–¥–∏–µ–Ω—Ç, —Å–≤–µ—á–µ–Ω–∏–µ)
- üé¨ –ê–Ω–∏–º–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –≤—Ö–æ–¥–∞
- üì± –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω

### –î–∞—à–±–æ—Ä–¥
- üìä –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ Chart.js 4.x
- üîÑ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- üé® –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–≤–µ—Ç–ª–æ–π/—Ç–µ–º–Ω–æ–π —Ç–µ–º—ã –¥–ª—è –≤—Å–µ—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤
- ‚ö° –ë—ã—Å—Ç—Ä–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏

## üöÄ –î–µ–ø–ª–æ–π –Ω–∞ Amvera

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
```bash
# –í Amvera Dashboard:
1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
2. –ü–æ–¥–∫–ª—é—á–∏—Ç—å GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
3. –í—ã–±—Ä–∞—Ç—å Node.js 18
```

### 2. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ PostgreSQL
```bash
# –í —Ä–∞–∑–¥–µ–ª–µ "–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö":
1. –°–æ–∑–¥–∞—Ç—å CNPG –∫–ª–∞—Å—Ç–µ—Ä PostgreSQL 17.5
2. –ü–æ–ª—É—á–∏—Ç—å —Ö–æ—Å—Ç—ã: RW, RO, R
3. –°–æ–∑–¥–∞—Ç—å –±–∞–∑—É "reports"
```

### 3. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ Settings ‚Üí Environment:
DB_HOST_RW=amvera-...-rw
DB_HOST_RO=amvera-...-ro
DB_HOST_R=amvera-...-r
DB_PORT=5432
DB_NAME=reports
DB_USER=reports_admin
DB_PASSWORD=***
SESSION_SECRET=***
NODE_ENV=production
PORT=80
```

### 4. –î–µ–ø–ª–æ–π
```bash
git push origin main
# Amvera –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–µ—Ä–µ—Ç –∏ –∑–∞–ø—É—Å—Ç–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Health Check
```bash
curl https://your-domain/health

# –û—Ç–≤–µ—Ç:
{
  "status": "ok",
  "timestamp": "2025-01-06T12:00:00.000Z",
  "database": "connected",
  "uptime": 3600
}
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –í—Å–µ SQL –∑–∞–ø—Ä–æ—Å—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `[SQL]`
- HTTP –∑–∞–ø—Ä–æ—Å—ã: –º–µ—Ç–æ–¥, URL, IP, –≤—Ä–µ–º—è
- –û—à–∏–±–∫–∏: –ø–æ–ª–Ω—ã–π stack trace

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **HTTPS** - –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- **Helmet** - CSP, XSS –∑–∞—â–∏—Ç–∞
- **Rate Limiting** - 1000 req/15 min
- **bcrypt** - –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π (10 —Ä–∞—É–Ω–¥–æ–≤)
- **–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã** - –ó–∞—â–∏—Ç–∞ –æ—Ç SQL Injection
- **CORS** - –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞
- **–°–µ—Å—Å–∏–∏** - –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ HTTP-only cookies

## üìù –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–ª—è –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–∞

1. **–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É**
   - –û—Ç–∫—Ä–æ–π—Ç–µ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
   - –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç
   - –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å
   - –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ —Å–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å

2. **–í–Ω–µ—Å–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –§–æ—Ä–º–∞ 1-–ì–ú–£**
   - –û—Ç–∫—Ä–æ–π—Ç–µ "–§–æ—Ä–º–∞ 1-–ì–ú–£"
   - –í—ã–±–µ—Ä–∏—Ç–µ –º–µ—Å—è—Ü
   - –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ Excel –∏–ª–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Ä—É—á–Ω—É—é
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

3. **–ò–º–ø–æ—Ä—Ç —É—Å–ª—É–≥**
   - –î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤—è—Ç—Å—è –Ω–∞ –¥–∞—à–±–æ—Ä–¥–µ
   - –ë–ª–∞–≥–æ–¥–∞—Ä—è —Ç—Ä–∏–≥–≥–µ—Ä—É —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

1. **–ü—Ä–æ—Å–º–æ—Ç—Ä –∞–Ω–∞–ª–∏—Ç–∏–∫–∏**
   - –û—Ç–∫—Ä–æ–π—Ç–µ "–û–±—â–∏–π –¥–∞—à–±–æ—Ä–¥"
   - –í—ã–±–µ—Ä–∏—Ç–µ –≤–∫–ª–∞–¥–∫—É (–î–¢–ü –∏–ª–∏ –£—Å–ª—É–≥–∏)
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã
   - –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ

2. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏**
   - API `/api/admin/users`
   - –°–æ–∑–¥–∞–Ω–∏–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ
   - –°–±—Ä–æ—Å –ø–∞—Ä–æ–ª–µ–π

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [QUICK_START.md](QUICK_START.md) - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –∑–∞ 5 –º–∏–Ω—É—Ç
- [SERVICES_IMPORT_GUIDE.md](SERVICES_IMPORT_GUIDE.md) - –ò–º–ø–æ—Ä—Ç —É—Å–ª—É–≥
- [MIGRATION_GUIDE.md](MIGRATION_GUIDE.md) - –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- [README_AUTH.md](README_AUTH.md) - –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `/health` endpoint
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ –ë–î
4. –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤ Amvera Dashboard
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç—Ä–∏–≥–≥–µ—Ä `trigger_sync_to_service_values`

## üîÑ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### v2.0 (–Ø–Ω–≤–∞—Ä—å 2025)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –¥–∞—à–±–æ—Ä–¥ —É—Å–ª—É–≥ —Å 4 –≥—Ä–∞—Ñ–∏–∫–∞–º–∏
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∏–º–ø–æ—Ä—Ç–∞ —É—Å–ª—É–≥ –∏–∑ Excel
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (—Ç—Ä–∏–≥–≥–µ—Ä)
- ‚úÖ –£–ª—É—á—à–µ–Ω UI: –∏–∫–æ–Ω–∫–∏, –∞–Ω–∏–º–∞—Ü–∏–∏, hover-—ç—Ñ—Ñ–µ–∫—Ç—ã
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–≤–µ—Ç–ª–æ–π —Ç–µ–º—ã
- ‚úÖ –î–∞—à–±–æ—Ä–¥ –ì–ò–ë–î–î (–î–¢–ü)

### v1.0 (2024)
- ‚úÖ –§–æ—Ä–º–∞ 1-–ì–ú–£
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ë–∞–∑–æ–≤—ã–π –¥–∞—à–±–æ—Ä–¥

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

¬© 2024-2025 –ê–ù–û "–û–±–ª–∞—Å—Ç—å –ë—É–¥—É—â–µ–≥–æ"
–°–∏—Å—Ç–µ–º–∞ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–æ–≤ –õ–∏–ø–µ—Ü–∫–æ–π –æ–±–ª–∞—Å—Ç–∏

---

**–í–µ—Ä—Å–∏—è**: 2.0
**–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞**: Amvera Cloud
**–°—Ç–∞—Ç—É—Å**: Production Ready ‚úÖ
**Demo**: https://reports-system-alex1976.amvera.io
