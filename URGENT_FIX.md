# üö® –°–†–û–ß–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï - –û—à–∏–±–∫–∏ 500 –∏ 404

## –ü—Ä–æ–±–ª–µ–º—ã

1. ‚ùå –û—à–∏–±–∫–∞ 500 –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –æ—Ç—á–µ—Ç–∞
2. ‚ùå –û—à–∏–±–∫–∞ 404 –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ –≤ Excel (`/api/reports/export`)
3. ‚ùå –î–∞–Ω–Ω—ã–µ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ –¥—Ä—É–≥–∏—Ö —Ñ–æ—Ä–º–∞—Ö

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î
npm run db:check
```

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫–∏ - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:**

```bash
# 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
npm run db:init

# 3. –ó–∞–≥—Ä—É–∑–∫–∞ –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç–æ–≤
npm run db:migrate

# 4. –ü–ï–†–ï–ó–ê–ü–£–°–ö –°–ï–†–í–ï–†–ê (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ!)
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–Ω–æ–≤–æ:
npm start
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ª–æ–≥–∞—Ö —Å–µ—Ä–≤–µ—Ä–∞

**–ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞ –∏—â–∏—Ç–µ —Å—Ç—Ä–æ–∫—É:**
```
DB mapping: { indicatorsCatalog: '...', indicatorValues: '...', ... }
```

**–ï—Å–ª–∏ `indicatorValues: null` - –ë–î –ù–ï –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞!**

## –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ SSH –Ω–∞ Amvera

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh your-amvera-instance

# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
cd /path/to/reports-system

# –ü—Ä–æ–≤–µ—Ä–∫–∞
npm run db:check

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
npm run db:init

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
pm2 restart all
# –∏–ª–∏
systemctl restart your-app-service
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ Amvera Dashboard

1. –û—Ç–∫—Ä–æ–π—Ç–µ Amvera Dashboard
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "Environment Variables"
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
   ```
   DB_HOST=amvera-alex1976-cnpg-reports-db-rw
   DB_PORT=5432
   DB_NAME=reports
   DB_USER=reports_admin
   DB_PASSWORD=Qwerty12345!
   ```
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "Console" –∏–ª–∏ "SSH"
5. –í—ã–ø–æ–ª–Ω–∏—Ç–µ:
   ```bash
   npm run db:init
   ```
6. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Dashboard

### –í–∞—Ä–∏–∞–Ω—Ç 3: SQL –Ω–∞–ø—Ä—è–º—É—é

–ï—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ PostgreSQL:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü
SELECT tablename FROM pg_tables WHERE schemaname = 'public';

-- –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü –Ω–µ—Ç, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Ñ–∞–π–ª—ã:
\i database/schema.sql
\i database/seed_data.sql
```

## –ü–æ—á–µ–º—É –≤–æ–∑–Ω–∏–∫–∞—é—Ç –æ—à–∏–±–∫–∏

### –û—à–∏–±–∫–∞ 500 –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
**–ü—Ä–∏—á–∏–Ω–∞:** `DB.indicatorValues = null`
- –¢–∞–±–ª–∏—Ü–∞ `indicator_values` –Ω–µ —Å–æ–∑–¥–∞–Ω–∞
- –ò–ª–∏ —Å–æ–∑–¥–∞–Ω–∞ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (–Ω—É–∂–µ–Ω —Ä–µ—Å—Ç–∞—Ä—Ç)

### –û—à–∏–±–∫–∞ 404 –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ Excel
**–ü—Ä–∏—á–∏–Ω–∞:** –†–æ—É—Ç `/api/reports/export` –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ `server.js` –µ—Å—Ç—å —Å—Ç—Ä–æ–∫–∞ 435-539
- –í–æ–∑–º–æ–∂–Ω–æ —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è –∫–æ–¥–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–†–µ—à–µ–Ω–∏–µ:**
```bash
git pull origin main
npm start
```

### –î–∞–Ω–Ω—ã–µ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
**–ü—Ä–∏—á–∏–Ω—ã:**
1. –ë–î –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ (–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö)
2. API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç—ã–µ –º–∞—Å—Å–∏–≤—ã
3. JS-–æ—à–∏–±–∫–∏ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

## –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç

- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ (`npm run db:check`)
- [ ] –¢–∞–±–ª–∏—Ü—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –¥–∞–Ω–Ω—ã–µ:
  - `municipalities` - –º–∏–Ω–∏–º—É–º 1 –∑–∞–ø–∏—Å—å
  - `indicators_catalog` - 10 –∑–∞–ø–∏—Å–µ–π (form_1_gmu)
  - `services_catalog` - 25 –∑–∞–ø–∏—Å–µ–π
- [ ] –ö–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∞–∫—Ç—É–∞–ª–µ–Ω (`git pull origin main`)
- [ ] –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –ü–û–°–õ–ï –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î
- [ ] –í –ª–æ–≥–∞—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ: `DB mapping` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã
- [ ] –§–æ—Ä–º–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ JS-–æ—à–∏–±–æ–∫ (F12 ‚Üí Console)
- [ ] API –æ—Ç–≤–µ—á–∞—é—Ç:
  - GET /api/municipalities ‚Üí —Å–ø–∏—Å–æ–∫
  - GET /api/indicators/form_1_gmu ‚Üí 10+ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
  - GET /api/service-categories ‚Üí –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
  - GET /api/services ‚Üí —É—Å–ª—É–≥–∏

## –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ API (–∑–∞–º–µ–Ω–∏—Ç–µ localhost –Ω–∞ –≤–∞—à –¥–æ–º–µ–Ω)
curl http://localhost/api/municipalities
curl http://localhost/api/indicators/form_1_gmu
curl http://localhost/api/service-categories

# –î–æ–ª–∂–Ω—ã –≤–µ—Ä–Ω—É—Ç—å JSON —Å –¥–∞–Ω–Ω—ã–º–∏, –∞ –Ω–µ []
```

## –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç

### –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞:

```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
pm2 stop all

# 2. –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—É—é –ë–î (–í–ù–ò–ú–ê–ù–ò–ï: —É–¥–∞–ª–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ!)
# –í–æ–π–¥–∏—Ç–µ –≤ psql:
psql -U reports_admin -d reports

# –í psql:
DROP SCHEMA public CASCADE;
CREATE SCHEMA public;
\q

# 3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å –Ω—É–ª—è
npm run db:init
npm run db:migrate

# 4. –ó–∞–ø—É—Å–∫
npm start
```

## –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ç–∫—Ä–æ–π—Ç–µ:

1. **–§–æ—Ä–º–∞:** http://your-domain/form
   - –î–æ–ª–∂–Ω—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –º—É–Ω–∏—Ü–∏–ø–∞–ª–∏—Ç–µ—Ç—ã
   - –î–æ–ª–∂–Ω—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥
   - –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚Üí —É—Å–ª—É–≥–∏
   - –ü—Ä–∏ –≤—ã–±–æ—Ä–µ —É—Å–ª—É–≥–∏ ‚Üí —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞
   - –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

2. **–î–∞—à–±–æ—Ä–¥:** http://your-domain/dashboard
   - –í—ã–ø–∞–¥–∞—é—â–∏–µ —Å–ø–∏—Å–∫–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
   - –ì—Ä–∞—Ñ–∏–∫ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

3. **–ì–ª–∞–≤–Ω–∞—è:** http://your-domain/
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ü–∏—Ñ—Ä—ã

## –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

**–í–∫–ª—é—á–∏—Ç–µ –≤ .env:**
```env
NODE_ENV=development
LOG_LEVEL=debug
```

**–°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏:**
```bash
# –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
pm2 logs

# –ò–ª–∏
tail -f /var/log/app.log
```

**–ò—â–∏—Ç–µ:**
- `[SAVE REPORT] Error:` - –æ—à–∏–±–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
- `DB mapping:` - –∫–∞–∫–∏–µ —Ç–∞–±–ª–∏—Ü—ã –Ω–∞–π–¥–µ–Ω—ã
- `Failed to resolve tables` - –Ω–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ —Ç–∞–±–ª–∏—Ü—ã
